{"version":3,"sources":["webpack://messenger/webpack/bootstrap","webpack://messenger/../components/src/interface.js","webpack://messenger/../components/src/Theme.js","webpack://messenger/../common/src/index.js","webpack://messenger/./src/utils/builder.js","webpack://messenger/../messaging/src/messaging.js","webpack://messenger/../components/src/index.js","webpack://messenger/../components/src/components/Message/index.js","webpack://messenger/./src/hooks/ui.js","webpack://messenger/./src/hooks/useLocalStorage.js","webpack://messenger/./src/utils/styled/genStyle.js","webpack://messenger/./src/utils/styled/index.js","webpack://messenger/./src/utils/store/index.js","webpack://messenger/./src/index.js","webpack://messenger/../messaging/src/index.js","webpack://messenger/../messaging/src/dialog.js","webpack://messenger/../dialog/src/index.js","webpack://messenger/../dialog/src/dialog.js","webpack://messenger/../common/src/utils/dateTools.js","webpack://messenger/../common/src/utils/deepCopy.js","webpack://messenger/../messaging/src/echo.js","webpack://messenger/./src/ZiiirClient.js","webpack://messenger/../components/src/Messenger/index.js","webpack://messenger/../components/src/Messenger/Messenger.js","webpack://messenger/../components/src/components/Box/index.js","webpack://messenger/../components/src/components/Box/Box.js","webpack://messenger/../components/src/components/Header/index.js","webpack://messenger/../components/src/components/Header/Header.js","webpack://messenger/../components/src/components/List/index.js","webpack://messenger/../components/src/components/List/List.js","webpack://messenger/../components/src/components/Footer/index.js","webpack://messenger/../components/src/components/Footer/Footer.js","webpack://messenger/../components/src/components/Message/Message.js","webpack://messenger/../components/src/components/Carousel/index.js","webpack://messenger/../components/src/components/Carousel/Carousel.js","webpack://messenger/../components/src/components/Card/index.js","webpack://messenger/../components/src/components/Card/Card.js","webpack://messenger/../components/src/components/Input/index.js","webpack://messenger/../components/src/components/Input/Input.js","webpack://messenger/../components/src/components/FAButton/index.js","webpack://messenger/../components/src/components/FAButton/FAButton.js","webpack://messenger/./src/hooks/useState.js","webpack://messenger/./src/utils/styled/fonts.js","webpack://messenger/./src/MessengerApp.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Interface","html","styled","createElement","useRef","palette","primary","secondary","background","surface","onPrimary","onSecondary","onBackground","onSurface","disabledText","border","fonts","font","family","size","style","weight","spacing","radius","smallRadius","shadow","messenger","width","height","message","element","props","children","definition","deepCopy","array","length","Array","isArray","filter","v","undefined","render","container","state","insert","innerText","el","document","keys","forEach","type","isAttribute","setCurrent","className","substring","addEventListener","toLowerCase","setAttribute","defaultProps","theme","genClassRules","dangerouslySetInnerHTML","innerHTML","__html","child","before","insertBefore","appendChild","e","current","ref","async","listener","messages","_messages","_m","created_time","Date","now","push","from","text","extra","Messenger","Message","FAButton","default","ui","initialValue","storedValue","setStoredValue","item","window","localStorage","getItem","JSON","parse","error","valueToStore","Function","setItem","stringify","styleSheet","genStyle","styledObj","styles","parameters","findMedias","_obj","rules","obj","trim","index","subIndex","indexOf","main","lastIndexOf","medias","sheet","title","getElementsByTagName","getStylesheet","selectors","selector","map","Math","random","join","sub","genClassRule","css","insertRule","unshift","store","initialState","_store","saveStore","messageListener","root","body","config","configFile","dataset","response","fetch","json","err","src","sources","intents","messagingType","messaging","getMessages","createMessage","sendMessage","commands","handleEventMessage","actions","ziiircom","contexts","_contexts","options","globalActions","addMessage","cmds","matchIntents","buildResponse","matchs","quick_replies","quickReplies","template","userId","newMessages","msg","to","newActions","_action","action","variables","id","Dialog","preprocessSentence","sentence","set","replace","match","preprocessOutput","output","j","getValue","_value","entities","htmlRenderer","complexLabel","complexUrl","url","label","imgUrl","testIntentConditions","conditions","context","findIndex","extractAndMatch","input","sentenceB","offset","eq","generateOutput","_context","intent","txt","_name","renderTemplate","_intents","initialContexts","fallback","resp","renderer","matchIndex","find","any","topic","_intent","preprocessIntent","inputIndex","sort","a","b","order","date","locale","remaining","years","floor","months","days","toLocaleString","hours","mins","_elements","stack","assign","elements","copy","getTime","k","ek","pop","echo","setup","personas","getAvatar","avatar","handleAction","storeMessages","storedMessages","_storeMessages","renderMessage","hasPrevious","hasNext","getElementsByClassName","createdtime","fromUser","onAction","hideDate","parseInt","getAttribute","ms","prev","next","scrollTop","scrollHeight","currentMessages","saveMessages","firstChild","remove","resetMessages","params","headers","form","encodeURIComponent","method","postFormAction","_getMessages","dialogOptions","payload","isOpen","msgs","charAt","StyledMessenger","Box","Theme","MessengerHeader","Header","MessengerFooter","Footer","Conversation","List","FooterInputContainer","FooterInput","Input","SendButton","sendButton","isExpanded","display","header","_header","onMessage","onClick","headerText","inputRef","Messages","m1","m2","inputComponent","handleKey","event","target","handleSend","onKeyUp","placeholder","buttoncontent","icon","disableDesktop","href","HeaderStyled","CloseBut","closeButton","CloseIcon","onClose","button","buttonBorder","buttonBackgroundColor","buttonColor","color","Styled","link","StyledReplies","EmptyAvatar","Avatar","meta","friendlyDate","handleQuickClick","preventDefault","parentNode","handleTemplateAction","stopPropagation","lastComponent","qr","Carousel","alt","tagName","textContent","CarouselStyled","Scroll","cardsComponents","Card","scrollContainer","CardStyled","ButtonStyled","imageUrl","buttons","defaultAction","buttonsComponents","buttonDef","Fab","_color","_bubbleColor","bubbleColor","iconActive","dispatcher","states","reset","useState","setState","newValue","heading","fontMessengerTextEl","fontMessengerHeadingEl","head","cssText","_isOpen","useSelector","messengerRef","fabRef","handleFabClick","classList","toggle","contains","MessengerBox"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst Interface = {};\n\nexport const setup = ({ html, styled, createElement, useRef }) => {\n  if (!Interface.html) {\n    Interface.html = html;\n    Interface.styled = styled;\n    Interface.createElement = createElement;\n    Interface.useRef = useRef;\n    // Object.freeze(Interface);\n  }\n  return Interface;\n};\n\nexport default Interface;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst Theme = {\n  palette: {\n    primary: '#F03F29',\n    secondary: '#1EA7FD',\n    background: 'smokewhite',\n    surface: '#F0F0F0',\n    onPrimary: 'white',\n    onSecondary: 'white',\n    onBackground: 'black',\n    onSurface: 'gray',\n    disabledText: 'lightGrey',\n    border: '#EAEAEA',\n  },\n  fonts: [],\n  font: {\n    family: 'sans-serif',\n    size: '16px',\n    style: 'normal',\n    weight: '400',\n  },\n  spacing: 8,\n  radius: 12,\n  smallRadius: 4,\n  shadow:\n    'rgba(0, 0, 0, 0.2) 0px 2px 4px -1px, rgba(0, 0, 0, 0.14) 0px 4px 5px 0px, rgba(0, 0, 0, 0.12) 0px 1px 10px 0px',\n\n  messenger: {\n    width: '500px',\n    height: '600px',\n  },\n\n  message: {\n    radius: 16,\n    smallRadius: 4,\n    shadow: 'none',\n  },\n};\n\nexport default Theme;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { friendlyDate } from './utils/dateTools';\nimport deepCopy from './utils/deepCopy';\n\nexport { friendlyDate, deepCopy };\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { deepCopy } from '@ziiircom/common';\nimport { genClassRules } from './styled/genStyle';\n\nexport const html = () => {\n  // TODO\n};\n\nexport const createElement = (element, props, ...children) => {\n  let definition;\n  if (element.element) {\n    definition = deepCopy({}, element);\n    definition.props = deepCopy({}, definition.props, props);\n  } else {\n    definition = { props: {} };\n    definition.element = element;\n    if (props) {\n      definition.props = props;\n    }\n  }\n  let array = children;\n  if (children.length === 1 && Array.isArray(children[0])) {\n    [array] = children;\n  }\n  definition.children = array.filter((v) => v !== undefined);\n  return definition;\n};\n\nexport const render = (element, container, state = {}, insert) => {\n  if (!element) {\n    return;\n  }\n  if (typeof element === 'string') {\n    const c = container;\n    c.innerText = element;\n    return;\n  }\n\n  let { children } = element;\n  if (typeof element.element === 'string') {\n    const el = document.createElement(element.element);\n    if (element.props) {\n      Object.keys(element.props).forEach((n) => {\n        const v = element.props[n];\n        const type = typeof v;\n        const isAttribute = type === 'string' || type === 'number' || type === 'boolean';\n        if (n === 'ref') {\n          v.setCurrent(el);\n        } else if (n === 'className') {\n          el.className = v;\n        } else if (type === 'function') {\n          if (n.substring(0, 2) === 'on') {\n            el.addEventListener(n.substring(2).toLowerCase(), v);\n          }\n        } else if (isAttribute) {\n          el.setAttribute(n, v);\n        }\n      });\n    }\n    if (element.styled) {\n      const defaultProps = { ...element.defaultProps };\n      const theme = state.theme || {};\n      const props = deepCopy(defaultProps, element.props, { theme });\n      let className = genClassRules(element.styled, props, defaultProps);\n      if (element.props.className) {\n        className += ` ${element.props.className}`;\n      }\n      el.className = className;\n    }\n    if (element.props && element.props.dangerouslySetInnerHTML) {\n      // eslint-disable-next-line no-underscore-dangle\n      el.innerHTML = element.props.dangerouslySetInnerHTML.__html;\n    }\n    if (children) {\n      children.forEach((child) => {\n        render(child, el, state);\n      });\n    }\n    if (insert && insert.before) {\n      container.insertBefore(el, insert.before);\n    } else {\n      container.appendChild(el);\n    }\n  } else if (typeof element === 'function') {\n    const e = element({ ...element.props, children, styled: element.styled });\n    render(e, container, state);\n    children = null;\n  } else if (element.element && typeof element.element === 'function') {\n    const e = element.element({ ...element.props, children });\n    if (element.styled) {\n      e.styled = [...element.styled, ...e.styled];\n    }\n    render(e, container, state);\n    children = null;\n  }\n};\n\nexport const useRef = (current) => {\n  const ref = {\n    current,\n    setCurrent: (el) => {\n      ref.current = el;\n    },\n  };\n  return ref;\n};\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { deepCopy } from '@ziiircom/common';\n\n// Messaging service\nconst useMessaging = async ({ listener, messages: _messages }) => {\n  let messages = [];\n  if (_messages) {\n    _messages.forEach((_m) => {\n      const m = deepCopy(_m);\n      if (!m.created_time) {\n        m.created_time = Date.now();\n      }\n      messages.push(m);\n    });\n  }\n\n  const createMessage = (from, text, ...extra) => ({ from, text, ...extra, created_time: Date.now() });\n\n  const sendMessage = undefined;\n\n  const commands = async (type) => {\n    if (type === '#reset') {\n      listener({ type: 'resetMessages' });\n      messages = [];\n    } else {\n      listener({ type: 'unknownCommand' });\n    }\n  };\n\n  const addMessage = (message) => messages.push(deepCopy(message));\n\n  const getMessages = async () => deepCopy(messages);\n\n  return [addMessage, getMessages, createMessage, sendMessage, commands];\n};\n\nexport default useMessaging;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface, { setup } from './interface';\n\nexport { setup, Interface };\n\nconst ui = async () => {\n  const Messenger = await import('./Messenger/index.js');\n  const Message = await import('./components/Message/index.js');\n  const FAButton = await import('./components/FAButton/index.js');\n  return { Messenger: Messenger.default, Message: Message.default, FAButton: FAButton.default };\n};\n\nexport default ui;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport Message from './Message';\n\nexport default Message;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport UI from '@ziiircom/components';\n\nlet ui;\n\nconst useUI = async () => {\n  if (!ui) {\n    ui = await UI();\n  }\n  return ui;\n};\n\nexport default useUI;\n","// https://usehooks.com/useLocalStorage/\nimport useState from './useState';\n\nexport default function useLocalStorage(key, initialValue) {\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      // Get from local storage by key\n      const item = window.localStorage.getItem(key);\n\n      // Parse stored json or if none return initialValue\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      // If error also return initialValue\n      // console.log(error);\n      return initialValue;\n    }\n  });\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue = (value) => {\n    try {\n      // Allow value to be a function so we have same API as useState\n      const valueToStore = value instanceof Function ? value(storedValue) : value;\n\n      // Save state\n      setStoredValue(valueToStore);\n\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      // A more advanced implementation would handle the error case\n      // console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nlet styleSheet;\n\nconst getStylesheet = () => {\n  if (!styleSheet) {\n    const style = document.createElement('style');\n    style.type = 'text/css';\n    style.title = 'MainCSS';\n    document.getElementsByTagName('head')[0].appendChild(style);\n    styleSheet = style.sheet;\n  }\n  return styleSheet;\n};\n\nconst c = 'abcdefghijklmnopqrstuvwxyz';\n// eslint-disable-next-line no-bitwise\nconst genSelector = () => [...Array(5)].map(() => c[~~(Math.random() * c.length)]).join('');\n\nconst genStyle = (styledObj, props) => {\n  let style = '';\n  if (styledObj && Array.isArray(styledObj.styles)) {\n    styledObj.styles.forEach((s, i) => {\n      style += s;\n      if (styledObj.parameters[i]) {\n        style += styledObj.parameters[i](props);\n      }\n    });\n  }\n  return style;\n};\n\nconst findMedias = (_obj, rules) => {\n  const obj = _obj;\n  if (rules.trim().length === 0) return;\n  let index = 0;\n  let subIndex = rules.indexOf('@', index);\n  while (subIndex > -1) {\n    obj.main += rules.substring(index, subIndex).trim();\n    const s = rules.indexOf('@', subIndex + 1);\n    if (s !== -1) {\n      index = s;\n    } else {\n      index = rules.lastIndexOf('}') + 1;\n      /* if (index === -1) {\n        index = rules.length;\n      } */\n    }\n    // Insert media query\n    obj.medias.push(rules.substring(subIndex, index));\n    subIndex = s;\n  }\n  obj.main += rules.substring(index).trim();\n};\n\nconst genClassRule = (obj, styledObj, props) => {\n  const rules = genStyle(styledObj, props);\n\n  let index = 0;\n  let subIndex = rules.indexOf('&', index);\n  if (subIndex === -1) {\n    // No sub-rules\n    findMedias(obj, rules);\n  } else {\n    while (subIndex > -1) {\n      findMedias(obj, rules.substring(index, subIndex));\n      index = rules.indexOf('}', subIndex + 2);\n      obj.sub.push(rules.substring(subIndex + 1, index + 1));\n      index += 1;\n      subIndex = rules.indexOf('&', index);\n    }\n    findMedias(obj, rules.substring(index));\n  }\n};\n\nconst genClassRules = (styled, props, defaultProps = {}) => {\n  const sheet = getStylesheet();\n  let selectors = '';\n  styled.forEach((styledObj) => {\n    const selector = defaultProps.selector || genSelector();\n    const obj = { main: '', sub: [], medias: [] };\n    genClassRule(obj, styledObj, props);\n    if (obj.main && obj.main.length > 0) {\n      let css = `.${selector} { ${obj.main} }`;\n      sheet.insertRule(css);\n      obj.sub.forEach((r) => {\n        css = `.${selector}${r}`;\n        sheet.insertRule(css);\n      });\n      obj.medias.forEach((r) => {\n        sheet.insertRule(r);\n      });\n      selectors += `${selector} `;\n    }\n  });\n\n  return selectors.trim();\n};\n\nexport { genStyle, genClassRules };\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { createElement } from '../builder';\nimport { genStyle } from './genStyle';\n\nconst styled = (element, props, ...children) => (styles, ...parameters) => {\n  const v = element;\n  const el = createElement(v, props, ...children);\n  if (el.styled) {\n    el.styled.unshift({ styles, parameters });\n  } else {\n    el.styled = [{ styles, parameters }];\n  }\n  return el;\n};\n\nexport { styled, genStyle };\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport useLocalStorage from '../../hooks/useLocalStorage';\n\nlet store;\n\nfunction useStore(initialState) {\n  const [_store, saveStore] = useLocalStorage('store', { ...initialState });\n  store = _store;\n  return [store, saveStore];\n}\nexport default useStore;\n\nexport const useSelector = (selector) => selector({ ...store });\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport useMessaging from '@ziiircom/messaging';\nimport { deepCopy } from '@ziiircom/common';\n\nimport ziiirClient from './ZiiirClient';\n\nconst messenger = async (initialState = {}, messageListener, root = document.body) => {\n  let { config } = initialState;\n  const { configFile = './config.json' } = initialState;\n  let dataset;\n\n  if (!config && configFile) {\n    try {\n      const response = await fetch(configFile);\n      config = await response.json();\n    } catch (err) {\n      // console.log('no config found');\n    }\n  }\n\n  if (!config) {\n    config = {};\n  }\n  const state = { ...config, ...initialState };\n  if (!state.messenger) {\n    state.messenger = {};\n  }\n  if (state.dataset) {\n    if (state.dataset.src) {\n      dataset = [];\n      const sources = Array.isArray(state.dataset.src) ? state.dataset.src : [state.dataset.src];\n      // eslint-disable-next-line no-restricted-syntax\n      for (const src of sources) {\n        try {\n          // eslint-disable-next-line no-await-in-loop\n          const response = await fetch(src);\n          // eslint-disable-next-line no-await-in-loop\n          const d = await response.json();\n          let intents;\n          if (d.intents) {\n            intents = deepCopy(dataset.intents, d.intents);\n          }\n          dataset = deepCopy(dataset, d);\n          if (intents) {\n            dataset.intents = intents;\n          }\n        } catch (err) {\n          // console.log('no intents found', err);\n        }\n      }\n      /* try {\n        const response = await fetch(state.dataset.src);\n        dataset = await response.json();\n      } catch (err) {\n        // console.log('no intents found', err);\n      } */\n    } else {\n      ({ dataset } = state);\n    }\n    if (dataset && dataset.intents) {\n      dataset = dataset.intents;\n    }\n  } else if (state.intents) {\n    if (state.intents.src) {\n      try {\n        const response = await fetch(state.intents.src);\n        dataset = await response.json();\n      } catch (err) {\n        // console.log('no intents found', err);\n      }\n    } else {\n      dataset = state.intents;\n    }\n  }\n  const messagingType = dataset ? 'dialog' : undefined;\n  const messaging = await useMessaging(messagingType);\n  // console.log('global actions=', state.actions);\n  const [store, getMessages, createMessage, sendMessage, commands, handleEventMessage] = await ziiirClient({\n    state,\n    messaging,\n    root,\n    messageListener,\n    dataset,\n    messages: state.messages,\n    actions: state.actions,\n  });\n  window.ziiircom = {\n    name: 'Ziiircom',\n    store,\n    getMessages,\n    createMessage,\n    sendMessage,\n    commands,\n    handleEventMessage,\n  };\n  return [store, getMessages, createMessage, sendMessage, commands, handleEventMessage];\n};\n\nif (process.env.NODE_ENV === 'development') {\n  messenger();\n}\n\nexport default messenger;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst useMessaging = async (type) => {\n  let messaging;\n  if (type === 'dialog') {\n    try {\n      messaging = (await import('./dialog')).default;\n    } catch (err) {\n      // console.log('no dialog found');\n    }\n  }\n  if (!messaging) {\n    try {\n      messaging = (await import('./echo')).default;\n    } catch (err) {\n      // console.log('no echo found');\n    }\n  }\n  return messaging;\n};\n\nexport default useMessaging;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Dialog from '@ziiircom/dialog';\nimport { deepCopy } from '@ziiircom/common';\nimport useMessaging from './messaging';\n\n// simple Dialog Messaging service\nconst useDialog = async ({\n  listener,\n  dataset: intents,\n  messages,\n  contexts: _contexts = {},\n  options,\n  actions: globalActions,\n}) => {\n  const [addMessage, getMessages, createMessage, , cmds] = await useMessaging({ listener, messages });\n  const contexts = deepCopy(_contexts);\n  const [matchIntents, buildResponse] = Dialog(intents, contexts, options);\n\n  const sendMessage = async (message) => {\n    addMessage(message);\n    await listener({ type: 'newMessage', message: deepCopy(message) });\n    const matchs = matchIntents(message);\n    const { response, quick_replies: quickReplies, template, actions, userId } = buildResponse(matchs);\n    const newMessages = [];\n    response.forEach((r, i) => {\n      const msg = createMessage('bot', r);\n      msg.to = userId;\n      if (i === response.length - 1 && quickReplies) {\n        msg.quick_replies = deepCopy(quickReplies);\n      }\n      if (i === response.length - 1 && template) {\n        msg.template = deepCopy(template);\n      }\n      addMessage(msg);\n      newMessages.push(deepCopy(msg));\n    });\n    await listener({ type: 'newMessage', message: newMessages });\n    if (actions) {\n      const newActions = actions.map((_action) => {\n        let action = _action;\n        if (!action.type) {\n          action = deepCopy(globalActions[action.name]);\n          // console.log('action from globalActions', _action.name, action);\n        }\n        const variables = {};\n        Object.keys(action.variables).forEach((name) => {\n          // console.log('context', name, contexts[userId][name]);\n          variables[name] = contexts[userId][name] || action.variables[name];\n        });\n        return { ...action, variables, userId };\n      });\n      await listener({ type: 'newAction', message: newActions });\n    }\n  };\n\n  const commands = async (type) => {\n    if (type === '#reset') {\n      Object.keys(contexts).forEach((id) => {\n        delete contexts[id];\n      });\n    }\n    return cmds(type);\n  };\n\n  return [getMessages, createMessage, sendMessage, commands];\n};\n\nexport default useDialog;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport Dialog from './dialog';\n\nexport default Dialog;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { deepCopy } from '@ziiircom/common';\n\nconst preprocessSentence = (sentence, set = {}) => {\n  const text = sentence.replace(/<<\\s*([\\w.]+)\\s*=\\s*(.+?)\\s*>>/g, (match, name, value) => {\n    // eslint-disable-next-line no-param-reassign\n    set[name] = value;\n    return '';\n  });\n  return { text, set };\n};\n\nconst preprocessOutput = (output) => {\n  let sentence;\n  if (Array.isArray(output)) {\n    // Sentence is an Array\n    sentence = output.map((s) => preprocessOutput(s));\n  } else if (output.text) {\n    // Sentence is an object\n    sentence = output;\n    if (Array.isArray(sentence.text)) {\n      // Sentence.text is an array\n      sentence.text.forEach((t, j) => {\n        ({ text: sentence.text[j], set: sentence.set } = preprocessSentence(t, sentence.set));\n      });\n    } else {\n      // Sentence.text is a string\n      ({ text: sentence.text, set: sentence.set } = preprocessSentence(sentence.text, sentence.set));\n    }\n    if (Object.keys(sentence.set).length === 0) {\n      delete sentence.set;\n    }\n  } else {\n    // Sentence is a string\n    const { text, set } = preprocessSentence(output);\n    if (Object.keys(set).length) {\n      sentence = { text, set };\n    } else {\n      sentence = text;\n    }\n  }\n  return sentence;\n};\n\nconst preprocessIntent = (_intent) => {\n  const intent = deepCopy(_intent);\n  const { output } = intent;\n  if (Array.isArray(output) && output.length && output[0].type === 'condition') {\n    intent.output = intent.output.map((o) => ({ ...o, children: preprocessOutput(o.children) }));\n  } else {\n    intent.output = preprocessOutput(output);\n  }\n\n  return intent;\n};\n\nconst getValue = (_value, entities) => {\n  let value = _value;\n  /* istanbul ignore next */\n  if (value === '*') {\n    [{ value }] = entities;\n  }\n  return value;\n};\n\nconst renderTemplate = (template, context, entities) => {\n  const set = {};\n  const response = template.replace(/{{\\s*([\\w.]+)\\s*(=\\s*(.+?)\\s*)*}}/g, (match, _name, eq, replace) => {\n    const name = _name.trim();\n    if (eq) {\n      set[name] = getValue(replace, entities);\n    }\n    const value = set[name] || context[name] || '';\n    return value;\n  });\n  return { response, set };\n};\n\nconst htmlRenderer = (message) => {\n  const html = message.replace(/https?:\\/\\/\\S*|\\[(.*?)\\]\\((.*?)\\)/gi, (match, complexLabel, complexUrl) => {\n    let url = match;\n    let label = url;\n    if (complexLabel) {\n      label = complexLabel;\n      url = complexUrl;\n    }\n    let imgUrl = url.match(/\\.(jpg|jpeg|gif|png|svg)$/gi) ? url : undefined;\n    if (!imgUrl && label.match(/\\.(jpg|jpeg|gif|png|svg)$/gi)) {\n      imgUrl = label;\n      label = label.substring(label.lastIndexOf('/') + 1, label.lastIndexOf('.'));\n    }\n    if (imgUrl) {\n      return `<a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"${imgUrl}\" alt=\"${label}\" /></a>`;\n    }\n    return `<a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\">${label}</a>`;\n  });\n  return html;\n};\n\nconst simpleMatch = (sentenceA, sentenceB) => sentenceA.toLowerCase() === sentenceB.toLowerCase();\n\nconst testIntentConditions = (conditions, context) =>\n  !conditions || conditions.length === 0 || conditions.findIndex((c) => c.name && context[c.name] === c.value) > -1;\n\nconst extractAndMatch = (input, text, conditions, context) => {\n  const entities = [];\n  let match;\n  let value = text;\n  if (testIntentConditions(conditions, context)) {\n    if (input === '*') {\n      entities.push({ type: 'any', value, offset: 0 });\n      match = true;\n    } else if (input.indexOf('{{') > -1) {\n      // Extract entities\n      input.replace(/{{\\s*([\\w.]*)\\s*(=?)\\s*@(any|email)\\s*}}/g, (m, name, eq, type, offset) => {\n        if (offset > 0) {\n          // TODO\n          value = undefined;\n        }\n        if (type === 'any') {\n          match = true;\n        } else if (type === 'email' && value && value.match(/\\b(\\w[-._\\w]*\\w@\\w[-._\\w]*\\w\\.\\w{2,3})\\b/gi)) {\n          match = true;\n        }\n        if (match) {\n          entities.push({ name, type, value, offset });\n        }\n      });\n    } else {\n      match = simpleMatch(input, text);\n      if (match) {\n        entities.push({ type: 'all', value, offset: 0 });\n      }\n    }\n  }\n\n  return [match, entities];\n};\n\nconst generateOutput = (match, _context) => {\n  const { intent } = match;\n  const { entities } = match;\n  let context = _context;\n  const response = [];\n  let quickReplies;\n  let template;\n  let actions;\n  // Store in context all variables changed\n  if (intent.set) {\n    context = { ...context, ...intent.set };\n  }\n  // handle condition #129\n  let { output } = intent;\n  if (Array.isArray(output)) {\n    output.forEach((o) => {\n      if (o.type === 'condition') {\n        output = null;\n        let value;\n        o.children.forEach((child) => {\n          if ((!output || !value) && (child.value === context[child.name] || !child.value)) {\n            ({ value } = child);\n            output = child;\n          }\n        });\n      }\n    });\n  }\n  if (output) {\n    let text = output;\n    if (output.text) {\n      ({ text } = output);\n    }\n    quickReplies = output.quick_replies;\n    template = output.template;\n    ({ actions } = output);\n    entities.forEach((e) => {\n      if (e.name) {\n        context[e.name] = e.value;\n      }\n    });\n    if (!Array.isArray(text)) {\n      text = [text];\n    }\n    text.forEach((t) => {\n      let txt = t;\n      if (txt.text) {\n        txt = txt.text;\n      }\n      const r = renderTemplate(txt, context, entities);\n      response.push(r.response);\n      if (Object.keys(r.set).length) {\n        context = { ...context, ...r.set };\n      }\n      const os = Array.isArray(output) ? output : [output];\n      os.forEach((o) => {\n        if (o.set) {\n          Object.keys(o.set).forEach((name) => {\n            context[name] = getValue(o.set[name], entities);\n          });\n        }\n      });\n    });\n  }\n  return [response, context, quickReplies, template, entities, actions];\n};\n\nconst Dialog = (_intents, initialContexts, options = { fallback: \"I don't understand\" }) => {\n  let resp;\n  const contexts = initialContexts || {};\n\n  const buildResponse = ({ matchs, userId = 'user', context: c = contexts[userId] || {} }, renderer = htmlRenderer) => {\n    let context = deepCopy(c);\n    let matchIndex = 0;\n    if (matchs && matchs.length > 1) {\n      matchs.find((m, i) => {\n        if (((m.intent.conditions && m.intent.conditions.length > 0) || !m.any) && m.intent.topic === context.topic) {\n          matchIndex = i;\n          return true;\n        }\n        return false;\n      });\n    }\n    let response = [];\n    let entities;\n    let quickReplies;\n    let template;\n    let actions;\n    if (matchs[matchIndex]) {\n      [response, context, quickReplies, template, entities, actions] = generateOutput(matchs[matchIndex], context);\n      contexts[userId] = context;\n    }\n    if (response.length === 0) {\n      response.push(options.fallback);\n    }\n    response = response.map((m) => renderer(m));\n    const output = { response, context, entities, userId };\n    if (quickReplies) {\n      output.quick_replies = quickReplies;\n    }\n    if (template) {\n      output.template = template;\n    }\n    if (actions) {\n      output.actions = actions;\n    }\n    return output;\n  };\n\n  if (_intents && Array.isArray(_intents) && _intents.length) {\n    const intents = _intents.map((i) => preprocessIntent(i));\n    let m;\n    let entities;\n    const matchIntent = (message, userId = 'user') => {\n      const context = contexts[userId] || {};\n      let matchs = [];\n      intents.forEach((intent) => {\n        let i =\n          Array.isArray(intent.input) && testIntentConditions(intent.conditions, context)\n            ? intent.input.findIndex((input) => {\n                [m, entities] = extractAndMatch(input, message.text);\n                return m;\n              })\n            : -1;\n        if (i === -1 && typeof intent.input === 'string') {\n          [m, entities] = extractAndMatch(intent.input, message.text, intent.conditions, context);\n          i = m ? 0 : -1;\n        }\n        if (i >= 0) {\n          m = { intent, inputIndex: i, entities };\n          if (entities.length === 1 && entities[0].type === 'any') {\n            m.any = true;\n          }\n          matchs.push(m);\n        }\n      });\n      matchs = matchs.sort((a, b) =>\n        a.intent.conditions &&\n        a.intent.conditions.length > 0 &&\n        (!b.intent.conditions || b.intent.conditions.length === 0)\n          ? -1\n          : (a.intent.order || 0) - (b.intent.order || 0),\n      );\n      return {\n        matchs,\n        context,\n        userId,\n      };\n    };\n    resp = [matchIntent, buildResponse];\n  }\n\n  return resp;\n};\n\nexport default Dialog;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst MILLISECONDS_TO_SECONDS = 0.001;\nconst SECONDS_IN_YEAR = 31557600;\nconst SECONDS_IN_MONTH = 2629800;\nconst SECONDS_IN_DAY = 86400;\nconst SECONDS_IN_HOUR = 3600;\nconst SECONDS_IN_MINUTE = 60;\n\nexport const friendlyDate = (date, locale) => {\n  let remaining = (Date.now() - date) * MILLISECONDS_TO_SECONDS;\n  const years = Math.floor(remaining / SECONDS_IN_YEAR);\n  remaining -= years * SECONDS_IN_YEAR;\n  const months = Math.floor(remaining / SECONDS_IN_MONTH);\n  remaining -= months * SECONDS_IN_MONTH;\n  const days = Math.floor(remaining / SECONDS_IN_DAY);\n  remaining -= days * SECONDS_IN_DAY;\n  if (months || years || days > 6) {\n    return new Date(date).toLocaleString(locale);\n  }\n  if (days > 1) {\n    return new Date(date).toLocaleString(locale);\n  }\n  if (days === 1) {\n    return 'yesterday';\n  }\n  const hours = Math.floor(remaining / SECONDS_IN_HOUR);\n  remaining -= hours * SECONDS_IN_HOUR;\n  if (hours > 1) {\n    return `${hours} hours ago`;\n  }\n  if (hours === 1) {\n    return `${hours} hour ago`;\n  }\n  const mins = Math.floor(remaining / SECONDS_IN_MINUTE);\n  remaining -= mins * SECONDS_IN_MINUTE;\n  if (mins > 1) {\n    return `${mins} mins ago`;\n  }\n  if (mins === 1) {\n    return `${mins} min ago`;\n  }\n  if (remaining > 10) {\n    return `${remaining} secs ago`;\n  }\n  return 'just now';\n};\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n\nconst deepCopy = (..._elements) => {\n  const stack = [];\n  const assign = (...elements) => {\n    let copy;\n    elements.forEach((e) => {\n      if (Array.isArray(e)) {\n        if (!copy) {\n          copy = [];\n        }\n        e.forEach((sub) => {\n          copy.push(assign(sub));\n        });\n      } else if (e instanceof Date) {\n        copy = new Date(e.getTime());\n      } else if (e && typeof e === 'object') {\n        stack.push(e);\n        if (!copy) {\n          copy = {};\n        }\n        stack.push(e);\n        Object.keys(e).forEach((k) => {\n          const ek = e[k];\n          if (stack.indexOf(ek) !== -1) {\n            // Circular ref\n            copy[k] = ek;\n          } else {\n            copy[k] = assign(copy[k], ek);\n          }\n        });\n        stack.pop();\n      } else if (e !== null && e !== undefined) {\n        copy = e;\n      }\n    });\n    return copy;\n  };\n  return assign(..._elements);\n};\n\nexport default deepCopy;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { deepCopy } from '@ziiircom/common';\nimport useMessaging from './messaging';\n\n// simple Echo Messaging service\nconst useEcho = async ({ listener, messages }) => {\n  const [addMessage, getMessages, createMessage, , commands] = await useMessaging({ listener, messages });\n\n  const sendMessage = async (message) => {\n    addMessage(message);\n    await listener({ type: 'newMessage', message: deepCopy(message) });\n    const echo = createMessage('bot', `You say : ${message.text}`);\n    addMessage(echo);\n    await listener({ type: 'newMessage', message: echo });\n  };\n  return [getMessages, createMessage, sendMessage, commands];\n};\n\nexport default useEcho;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { setup } from '@ziiircom/components';\nimport useUI from './hooks/ui';\nimport useLocalStorage from './hooks/useLocalStorage';\nimport { html, createElement, render, useRef } from './utils/builder';\nimport { styled } from './utils/styled';\nimport initFonts from './utils/styled/fonts';\nimport useStore from './utils/store';\nimport MessengerApp from './MessengerApp';\n\nconst postFormAction = (url, variables, params, headers = {}) => {\n  const form = Object.keys(params)\n    .map((key) => `${encodeURIComponent(key)}=${encodeURIComponent(variables[params[key]])}`)\n    .join('&');\n\n  fetch(url, {\n    method: 'POST',\n    headers: {\n      ...headers,\n      'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: form,\n  });\n};\n\nconst ZiiirClient = async ({\n  state,\n  messaging,\n  root,\n  messageListener = ({ type, message }) => ({ type, message }),\n  dataset,\n  messages: _messages,\n  actions,\n}) => {\n  setup({ html, createElement, styled, useRef });\n  const ui = await useUI();\n  const [store, saveStore] = useStore(state);\n  const personas = store.messenger.personas || {};\n\n  const getAvatar = (message) => {\n    let { avatar } = message;\n    if (!avatar) {\n      avatar = personas[message.from];\n    }\n    return avatar;\n  };\n\n  let handleAction;\n  let getMessages;\n\n  let messages = _messages;\n  let storeMessages = () => {};\n  if (store.messenger.localStorage) {\n    const [storedMessages, _storeMessages] = useLocalStorage('messages');\n    if (Array.isArray(storedMessages) && storedMessages.length > 0) {\n      messages = storedMessages;\n    }\n    storeMessages = _storeMessages;\n  }\n\n  const saveMessages = async () => {\n    const currentMessages = await getMessages();\n    storeMessages(currentMessages);\n  };\n\n  const resetMessages = async () => {\n    storeMessages([]);\n  };\n\n  const renderMessage = (message, hasPrevious, hasNext) => {\n    const container = document.getElementsByClassName('ziiir-conversation')[0];\n    const m = createElement(\n      ui.Message,\n      {\n        key: message.created_time,\n        createdtime: message.created_time,\n        avatar: getAvatar(message),\n        fromUser: message.from === 'user',\n        onAction: handleAction,\n        hideDate: state.messenger.hideDate,\n        hasPrevious,\n        hasNext,\n        quickReplies: message.quick_replies,\n        template: message.template,\n      },\n      message.text,\n    );\n    let insert;\n    // eslint-disable-next-line no-restricted-syntax\n    for (const c of container.children) {\n      const createdtime = parseInt(c.getAttribute('created-time'), 10);\n      if (message.created_time < createdtime) {\n        insert = { before: c };\n        break;\n      }\n    }\n    render(m, container, { ...store }, insert);\n  };\n\n  const handleEventMessage = async ({ type, message }) => {\n    const container = document.getElementsByClassName('ziiir-conversation')[0];\n    if (type === 'newMessage') {\n      if (Array.isArray(message)) {\n        message.forEach((m, i, ms) => {\n          const prev = ms[i - 1];\n          const hasPrevious = !!prev && prev.from === m.from && m.created_time - prev.created_time < 2000;\n          const next = ms[i + 1];\n          const hasNext = !!next && next.from === m.from && next.created_time - m.created_time < 2000;\n          renderMessage(m, hasPrevious, hasNext);\n        });\n      } else {\n        renderMessage(message);\n      }\n      container.scrollTop = container.scrollHeight;\n      saveMessages();\n    } else if (type === 'resetMessages') {\n      while (container.firstChild) {\n        container.firstChild.remove();\n      }\n      resetMessages();\n    } else if (type === 'newAction') {\n      // console.log('new action', message);\n      message.forEach((action) => {\n        if (action.type === 'postform') {\n          postFormAction(action.url, action.variables, action.params, action.headers);\n        }\n      });\n    }\n    messageListener({ type, message });\n  };\n  const [_getMessages, createMessage, sendMessage, commands] = await messaging({\n    listener: handleEventMessage,\n    messages,\n    dataset,\n    contexts: state.contexts,\n    options: state.messenger.dialogOptions,\n    actions,\n  });\n  getMessages = _getMessages;\n  const handleNewMessage = (text) => {\n    if (text.charAt(0) === '#') {\n      commands(text);\n    } else {\n      const message = createMessage('user', text);\n      sendMessage(message);\n    }\n  };\n\n  handleAction = (action, payload) => {\n    if (action === 'BUTTON') {\n      const message = createMessage('user', payload);\n      sendMessage(message);\n    } else if (action === 'TOGGLE_MESSENGER') {\n      store.messenger.isOpen = payload;\n      saveStore(store);\n    }\n  };\n\n  let msgs = await getMessages();\n  msgs = msgs.map((_m) => {\n    const m = _m;\n    m.avatar = getAvatar(m);\n    return m;\n  });\n\n  const el = await MessengerApp(msgs, handleNewMessage, handleAction, state.messenger.hideDate);\n  render(el, root, { ...store });\n  initFonts(state.theme, 'ziiircom-messenger-frame');\n  return [store, getMessages, createMessage, sendMessage, commands, handleEventMessage];\n};\n\nexport default ZiiirClient;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Messenger from './Messenger';\n\nexport default Messenger;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../interface';\nimport Box from '../components/Box';\nimport Header from '../components/Header';\nimport List from '../components/List';\nimport Footer from '../components/Footer';\nimport Message from '../components/Message';\nimport Input from '../components/Input';\nimport Theme from '../Theme';\n\nconst StyledMessenger = Interface.styled(Box)`\n  color: ${(props) => props.theme.palette.onSurface};\n  font-family: ${(props) => props.theme.font.family};\n  font-size: ${(props) => props.theme.font.size};\n  font-style: ${(props) => props.theme.font.style};\n  font-weight: ${(props) => props.theme.font.weight};\n  line-height: 1.1;\n  overflow-wrap: break-word;\n  padding: 0px;\n  width: ${(props) => props.theme.messenger.width};\n  height: ${(props) => props.theme.messenger.height};\n  display: flex;\n  border-radius: ${(props) => `${props.theme.radius}px`};\n  flex-direction: column;\n  box-shadow: ${(props) => props.theme.shadow};\n\n  & > p {\n    font-size: 13px;\n    line-height: 14px;\n    text-align: end;\n    padding-right: 16px;\n    margin: 4px 0;\n\n  }\n\n  &.isexpanded .ziiir-conversation {\n    animation: 0.675s cubic-bezier(0.4, 0, 0.2, 1) 0.45s 1 normal both running enterConversation;\n    animation-delay: 0.45s;\n    animation-fill-mode: both;\n  }\n\n  & .ziiir-conversation {\n    padding: 16px;\n    width: calc(100% - 32px);\n    height: calc(100% - 32px);\n    overflow-x: hidden;\n  }\n\n  & .ziiir-conversation > div {\n    webkit-flex: 0 0 100%;\n  }\n\n  @keyframes enterConversation {\n    0% {\n      height: 0;\n      padding: 0;\n      opacity: 0;\n    }\n  \n    50% {\n      opacity: 0;\n    }\n  \n    100% {\n      height: 100%;\n      padding: 16px;\n      opacity: 1;\n    }\n  }\n`;\n\nStyledMessenger.defaultProps = {\n  theme: Theme,\n};\n\nconst MessengerHeader = Interface.styled(Header)`\n  border-bottom: ${(props) => `1px solid ${props.theme.palette.border}`};\n  border-radius: ${(props) => `${props.theme.radius}px ${props.theme.radius}px 0 0`};\n`;\n\nMessengerHeader.defaultProps = {\n  theme: Theme,\n};\n\nconst MessengerFooter = Interface.styled(Footer)`\n  border-top: ${(props) => `1px solid ${props.theme.palette.border}`};\n  border-radius: ${(props) => `0 0 ${props.theme.radius}px ${props.theme.radius}px`};\n  display: flex;\n  flex-direction: column;\n\n  & button:hover {\n    color: ${(props) => props.theme.palette.onSurface};\n  }\n  & button img {\n    background-color: transparent;\n    filter: opacity(30%);\n  }\n  & button:hover img {\n    background-color: transparent;\n    filter: opacity(70%);\n  }\n`;\n\nMessengerFooter.defaultProps = {\n  theme: Theme,\n};\n\nconst Conversation = Interface.styled(List)`\n  transform-origin: center bottom 0px;\n  scroll-behavior: smooth;\n`;\n\nconst FooterInputContainer = Interface.styled('div')`\n  display: flex;\n  width: 100%;\n  padding: 4px;\n  margin: 0;\n  border: none;\n  outline: none;\n`;\n\nconst FooterInput = Interface.styled(Input)`\n  width: 100%;\n  padding: 4px;\n  margin: 0;\n  border: none;\n  outline: none;\n`;\n\nconst SendButton = Interface.styled('button')`\n  display: ${(props) => (props.sendButton ? 'block' : 'none')};\n  border: none;\n  outline: none;\n  cursor: pointer;\n  font-size: 16px;\n  padding-right: 0;\n  color: ${(props) => props.theme.palette.disabledText};\n  background-color: transparent;\n`;\nSendButton.defaultProps = {\n  theme: Theme,\n};\n\nconst e = Interface.createElement;\nconst m = (createdtime, msg, fromUser, avatar, onAction, hideDate, hasPrevious, hasNext, quickReplies, template) =>\n  e(\n    Message,\n    {\n      key: createdtime,\n      createdtime,\n      avatar,\n      fromUser,\n      onAction,\n      hideDate,\n      hasPrevious,\n      hasNext,\n      quickReplies,\n      template,\n    },\n    msg,\n  );\nconst Messenger = ({\n  isExpanded = true,\n  input = { display: true },\n  header: _header = {},\n  messages = [],\n  onMessage,\n  onClick,\n  onAction,\n  hideDate = false,\n}) => {\n  const { text: headerText = '', ...header } = _header;\n  const inputRef = Interface.useRef(null);\n  const Messages = e(\n    Conversation,\n    { isExpanded, className: 'ziiir-conversation' },\n    messages\n      .sort((m1, m2) => m1.created_time > m2.created_time)\n      .map((msg, i, ms) => {\n        const prev = ms[i - 1];\n        const hasPrevious = !!prev && prev.from === msg.from && msg.created_time - prev.created_time < 2000;\n        const next = ms[i + 1];\n        const hasNext = !!next && next.from === msg.from && next.created_time - msg.created_time < 2000;\n        return m(\n          msg.created_time,\n          msg.text,\n          msg.from === 'user',\n          msg.avatar,\n          onAction,\n          hideDate,\n          hasPrevious,\n          hasNext,\n          msg.quick_replies,\n          msg.template,\n        );\n      }),\n  );\n  let inputComponent = 'ziiir.com';\n  const handleKey = (event) => {\n    const value = event.target.value || '';\n    if (event.key === 'Enter' && value.length > 0) {\n      if (onMessage) {\n        onMessage(value);\n      }\n      // eslint-disable-next-line no-param-reassign\n      event.target.value = '';\n    }\n  };\n  const handleSend = () => {\n    const { value } = inputRef.current;\n    if (value && value.length && onMessage) {\n      onMessage(value);\n      inputRef.current.value = '';\n    }\n  };\n\n  if (input.display) {\n    inputComponent = e(FooterInput, {\n      className: 'ziiir-input',\n      onKeyUp: handleKey,\n      ref: inputRef,\n      placeholder: input.placeholder || 'Your message',\n    });\n    let buttoncontent = 'send';\n    if (input.sendButton && input.sendButton.icon) {\n      buttoncontent = e('img', {\n        src: input.sendButton.icon.src\n          ? input.sendButton.icon.src\n          : 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMi4wMSAyMUwyMyAxMiAyLjAxIDMgMiAxMGwxNSAyLTE1IDJ6Ii8+PC9zdmc+',\n      });\n    }\n    inputComponent = e(\n      FooterInputContainer,\n      null,\n      inputComponent,\n      e(\n        SendButton,\n        {\n          onClick: handleSend,\n          className: 'ziiir-send-button',\n          sendButton: input.sendButton && !input.sendButton.disableDesktop,\n        },\n        buttoncontent,\n      ),\n    );\n  }\n  return e(\n    StyledMessenger,\n    { className: isExpanded ? 'isexpanded' : undefined, onClick },\n    e(MessengerHeader, header, headerText),\n    Messages,\n    e('p', null, 'Powered by ', e('a', { href: 'https://ziiir.com', target: '_blank' }, 'ziiir.com')),\n    e(MessengerFooter, null, inputComponent),\n  );\n};\n\nexport default Messenger;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Box from './Box';\n\nexport default Box;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\nconst Box = Interface.styled('div')`\n  padding: 1.2em;\n  background: ${(props) => props.theme.palette.background};\n  color: #292c45;\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1.1;\n  overflow-wrap: break-word;\n`;\n\nBox.defaultProps = {\n  theme: Theme,\n};\n\nexport default Box;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Header from './Header';\n\nexport default Header;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\nconst HeaderStyled = Interface.styled('header')`\n  color: ${(props) => props.theme.palette.onPrimary};\n  font-size: 1.25em;\n  background: ${(props) => props.theme.palette.primary};\n  min-height: 64px;\n  padding-top: 1.2em;\n  padding-bottom: 1.2em;\n  padding-left: 1.2em;\n  padding-right: 0.3em;\n  display: flex;\n  @media only screen and (max-width: 772px) {\n    button:first-of-type {\n      display: block !important;\n    }\n  }\n`;\n\nHeaderStyled.defaultProps = {\n  theme: Theme,\n};\n\nconst CloseBut = Interface.styled('button')`\nwidth:24px;\nheight:24px;\nmargin: 0.6em 1.2em 1.2em -0.6em;\npadding: 4px;\nborder: none;\nborder-radius:100%;\ndisplay: ${(props) => (props.closeButton ? 'block' : 'none')};\nbackground-color: rgba(255, 255, 255, 0.2);\n&:hover {\n  background-color: rgba(255, 255, 255, 0.4);\n}\n`;\n\nconst CloseIcon = Interface.styled('div')`\nwidth:16px;\nheight:16px;\nbackground: transparent;\nbackground-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='white'%3E%3Cpath d='M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z'/%3E%3C/g%3E%3C/svg%3E\");\nbackground-repeat:no-repeat;\nbackground-position:50%;\nbackground-size:cover;\ncursor:pointer;\n`;\n\nCloseIcon.defaultProps = {\n  theme: Theme,\n};\n\nconst e = Interface.createElement;\nconst Header = ({ children, closeButton, onClose }) => {\n  // let container = e(HeaderStyled, null, children[0]);\n  const button = e(CloseBut, { closeButton, onClick: onClose }, e(CloseIcon));\n  return e(HeaderStyled, null, button, e('span', null, children[0]));\n  // return container;\n};\nexport default Header;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport List from './List';\n\nexport default List;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\nconst List = Interface.styled('div')`\n  padding: 0px;\n  background: ${(props) => props.theme.palette.background};\n  overflow-y: auto;\n`;\n\nList.defaultProps = {\n  theme: Theme,\n};\n\nexport default List;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Footer from './Footer';\n\nexport default Footer;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\nconst Footer = Interface.styled('div')`\n  color: ${(props) => props.theme.palette.disabledText};\n  font-size: 1em;\n  min-height: 36px;\n  padding-left: 16px;\n  padding-right: 16px;\n  display: flex;\n  margin-top: auto;\n  & > button {\n    align-self: flex-end;\n    line-height: 24px;\n  }\n`;\n\nFooter.defaultProps = {\n  theme: Theme,\n};\n\nexport default Footer;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { friendlyDate } from '@ziiircom/common';\nimport Interface from '../../interface';\nimport Carousel from '../Carousel';\nimport Theme from '../../Theme';\n\nconst buttonBorder = (palette, border = 'none') =>\n  palette.button && palette.button.border ? palette.button.border : border;\n\nconst buttonBackgroundColor = (palette) =>\n  palette.button && palette.button.background ? palette.button.background : palette.surface;\nconst buttonColor = (palette) => (palette.button && palette.button.color ? palette.button.color : palette.onSurface);\nconst Styled = Interface.styled('div')`\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  margin: ${(props) => (props.hasPrevious ? '-16px' : '12px')} 0px 0px;\n\n  cursor: default;\n\n  margin-left: ${(props) => (props.fromUser ? 'auto' : 0)};\n\n  &:first-child {\n    margin-top: 0px;\n  }\n\n  & > div {\n    display: flex;\n    flex-direction: column;\n    align-items: ${(props) => (props.fromUser ? 'flex-end' : 'flex-start')};\n    animation: 0.3s cubic-bezier(0, 0, 0.2, 1) 0s 1 normal both running ${(props) =>\n      props.fromUser ? 'enterMessageFromUser' : 'enterMessageFromBot'};\n    width: 100%;\n  }\n  & > div > p {\n    background-color: ${(props) => (props.fromUser ? props.theme.palette.surface : props.theme.palette.secondary)};\n    color: ${(props) => (props.fromUser ? props.theme.palette.onSurface : props.theme.palette.onSecondary)};\n    box-shadow: ${(props) => props.theme.message.shadow};\n    margin-bottom: 4px;\n    padding: 6px 16px;\n    border-radius: ${(props) => {\n      let { smallRadius, radius } = props.theme.message;\n      smallRadius += 'px';\n      radius += 'px';\n      return props.fromUser\n        ? `${radius} ${props.hasPrevious ? smallRadius : radius} ${props.hasNext ? smallRadius : `${radius} ${radius}`}`\n        : `${props.hasPrevious ? smallRadius : radius} ${radius} ${radius} ${props.hasNext ? smallRadius : radius}`;\n    }};\n    overflow-wrap: break-word;\n    line-height: 1.44;\n    width: fit-content;\n  }\n  & > div > span {\n    text-align: ${(props) => (props.fromUser ? 'right' : 'left')};\n    display: block;\n    margin: 0px 16px;\n    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) 0s;\n    opacity: 0.5;\n    font-size: 0.75rem;\n    font-weight: 400;\n    line-height: 1.66;\n  }\n  & > div > p > a {\n    color: ${(props) => props.theme.palette.link || 'inherit'};\n  }\n  & > div > p > a > img {\n    display: initial;\n  }\n  & > div > p > button {\n    border: ${(props) => buttonBorder(props.theme.palette)};\n    border-radius: 4px;\n    min-height: 24px;\n    margin: 8px 4px;\n    background: ${(props) => buttonBackgroundColor(props.theme.palette)};\n    color: ${(props) => buttonColor(props.theme.palette)};\n    cursor: pointer;\n    font-size: 16px;\n    font-family: ${(props) => props.theme.font.family};\n    font-weight: ${(props) => props.theme.font.weight};\n    padding: 1px 6px;\n  }\n  & > div > p > button:focus {\n    outline: none !important;\n  }\n  @keyframes enterMessageFromUser {\n    0% {\n      transform: translate( 0, 20px );\n      opacity: 0;\n    }\n  \n    100% {\n      transform: translate( 0, 0 );\n      opacity: 1;\n    }\n  }\n\n  @keyframes enterMessageFromBot {\n    0% {\n      transform: translate( - $message-avatar-size, 0 );\n      opacity: 0;\n    }\n  \n    100% {\n      transform: translate( 0, 0 );\n      opacity: 1;\n    }\n  }\n`;\n\nStyled.defaultProps = {\n  theme: Theme,\n};\n\nconst StyledReplies = Interface.styled('div')`\n  display: flex;\n  flex-flow: row wrap;\n  width: 100%;\n  & > button {\n    border: ${(props) => buttonBorder(props.theme.palette, `1px solid ${props.theme.palette.secondary}`)};\n    border-radius: 4px;\n    min-height: 24px;\n    margin: 8px 4px;\n    background: ${(props) => buttonBackgroundColor(props.theme.palette)};\n    color: ${(props) => buttonColor(props.theme.palette)};\n    cursor: pointer;\n    font-size: 16px;\n  }\n`;\n\nStyledReplies.defaultProps = {\n  theme: Theme,\n};\n\nconst EmptyAvatar = Interface.styled('span')`\n  z-index: 3;\n  flex-shrink: 0;\n  width: 40px;\n  height: 40px;\n  margin-top: auto;\n  margin-right: 8px;\n`;\n\nconst Avatar = Interface.styled('img')`\n  z-index: 3;\n  flex-shrink: 0;\n  width: 40px;\n  height: 40px;\n  margin-top: auto;\n  margin-right: 8px;\n  animation: 0.3s cubic-bezier(0.4, 0, 0.2, 1) 0s 1 normal none running enterAvatar;\n  border-radius: 50%;\n\n  @keyframes enterAvatar {\n    0% {\n      transform: scale( .5, .5 );\n      opacity: 0;\n    }\n  \n    30% {\n      transform: scale( 1.25, 1.25 );\n      opacity: 1;\n    }\n  \n    80% {\n      transform: scale( .9, .9 );\n    }\n  \n    100% {\n      transform: scale( 1, 1 );\n    }\n  }  \n`;\n\nconst e = Interface.createElement;\nconst Message = ({\n  createdtime,\n  avatar,\n  fromUser = true,\n  children,\n  onAction = () => {},\n  hideDate = false,\n  hasPrevious = false,\n  hasNext = false,\n  quickReplies,\n  template,\n}) => {\n  const meta = friendlyDate(createdtime);\n  let html = children;\n  let body = children;\n  if (Array.isArray(html)) {\n    [html] = children;\n  }\n  if (\n    typeof html === 'string' &&\n    (html.indexOf('/>') > 0 || html.indexOf('</') > 0 || html.indexOf('/&gt;') > 0 || html.indexOf('&lt;/') > 0)\n  ) {\n    html = { __html: html };\n    body = undefined;\n  } else {\n    html = undefined;\n  }\n\n  const handleClick = (event) => {\n    if (event.target.tagName === 'BUTTON') {\n      onAction(event.target.tagName, event.target.textContent);\n    }\n  };\n\n  const handleQuickClick = (event) => {\n    event.preventDefault();\n    const parent = event.target.parentNode;\n    parent.style.display = 'none';\n  };\n\n  const handleTemplateAction = (event, payload) => {\n    event.stopPropagation();\n    event.preventDefault();\n    onAction('BUTTON', payload);\n    const parent = event.target.parentNode;\n    parent.parentNode.style.display = 'none';\n  };\n\n  let lastComponent;\n  if (quickReplies) {\n    lastComponent = e(\n      StyledReplies,\n      {},\n      quickReplies.map((qr) => e('button', { key: qr.title, onClick: handleQuickClick }, qr.title)),\n    );\n  } else if (template) {\n    lastComponent = e(Carousel, { ...template, onAction: handleTemplateAction });\n  } else if (!hideDate && !hasNext) {\n    lastComponent = e('span', null, meta);\n  }\n  return e(\n    Styled,\n    { fromUser, 'created-time': createdtime, hasPrevious, hasNext },\n    avatar && (hasNext ? e(EmptyAvatar) : e(Avatar, { src: avatar.src, alt: avatar.name })),\n    e(\n      'div',\n      { onClick: handleClick },\n      e('p', { dangerouslySetInnerHTML: html }, body),\n      lastComponent,\n      /* !hideDate && !quickReplies && !hasNext && e('span', null, meta),\n      quickReplies &&\n        e(\n          StyledReplies,\n          {},\n          quickReplies.map((qr) => e('button', { key: qr.title, onClick: handleQuickClick }, qr.title)),\n        ), */\n    ),\n  );\n};\n\nexport default Message;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Carousel from './Carousel';\n\nexport default Carousel;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\nimport Card from '../Card';\n\nconst CarouselStyled = Interface.styled('div')`\n    font-size: 1em;\n    display: flex;\n    width: 100%;\n    flex-direction: row;\n    font-family: ${(props) => props.theme.font.family};\n    font-weight: ${(props) => props.theme.font.weight};\n    margin: 0;\n    padding: 0;\n    & > div {\n     margin-right: 0.15em;\n    }\n    & > div:first-of-type {\n      border-top-left-radius: ${(props) => props.theme.message.radius}px;\n      border-bottom-left-radius: ${(props) => props.theme.message.radius}px;\n    }\n    & > div:first-of-type > img {\n      border-top-left-radius: ${(props) => props.theme.message.radius}px;\n    }\n    & > div:last-of-type {\n      border-top-right-radius: ${(props) => props.theme.message.radius}px;\n      border-bottom-right-radius: ${(props) => props.theme.message.radius}px;\n    }\n    & > div:last-of-type > img {\n      border-top-right-radius: ${(props) => props.theme.message.radius}px;\n    }\n  `;\n\nCarouselStyled.defaultProps = {\n  theme: Theme,\n};\n\nconst Scroll = Interface.styled('div')`\n   width: 100%;\n   overflow-x: auto;\n`;\n\nCarouselStyled.defaultProps = {\n  theme: Theme,\n};\n\nconst e = Interface.createElement;\nconst Carousel = ({ elements, onAction = () => {} }) => {\n  const cardsComponents = [];\n  elements.forEach((element, index) => {\n    const button = e(Card, {\n      onAction: (event, action, i) => {\n        onAction(event, action, index, i);\n      },\n      ...element,\n    });\n    cardsComponents.push(button);\n  });\n  const scrollContainer = e(CarouselStyled, undefined, cardsComponents);\n  return e(Scroll, undefined, scrollContainer);\n};\nexport default Carousel;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Card from './Card';\n\nexport default Card;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\nconst CardStyled = Interface.styled('div')`\n   font-size: 1em;\n   display: flex;\n   width: fit-content; \n   flex-direction: column;\n   font-family: ${(props) => props.theme.font.family};\n   font-weight: ${(props) => props.theme.font.weight};\n   margin: 0;\n   padding: 0;\n   border-radius: 3px;\n   color: ${(props) => props.theme.palette.secondary};\n   border: 1px solid ${(props) => props.theme.palette.border};\n   background: none;\n   cursor: pointer;\n   & > p {\n    margin: 0.6em 0.3em;\n    color: ${(props) => props.theme.palette.onBackground};\n   }\n   & > img {\n    max-width: 180px;\n   }\n `;\n\nCardStyled.defaultProps = {\n  theme: Theme,\n};\n\nconst ButtonStyled = Interface.styled('button')`\n   font-size: 1em;\n   font-family: ${(props) => props.theme.font.family};\n   font-weight: ${(props) => props.theme.font.weight};\n   margin: 0;\n   padding: 0.6em 1em;\n   color: ${(props) => props.theme.palette.secondary};\n   border-top: 1px solid ${(props) => props.theme.palette.border} !important;\n   border: none;\n   background: none;\n   cursor: pointer;\n   &:hover {\n     color: ${(props) => props.theme.palette.onSecondary};\n     border-top: 1px solid ${(props) => props.theme.palette.secondary};\n     background: ${(props) => props.theme.palette.secondary};\n   }\n `;\n\nButtonStyled.defaultProps = {\n  theme: Theme,\n};\n\nconst e = Interface.createElement;\nconst Card = ({ title, imageUrl, buttons = [], onAction = () => {}, defaultAction }) => {\n  const buttonsComponents = [];\n  buttons.forEach((buttonDef, index) => {\n    const button = e(ButtonStyled, { onClick: (event) => onAction(event, buttonDef.payload, index) }, buttonDef.title);\n    buttonsComponents.push(button);\n  });\n  const handleDefaultAction = (event) => {\n    if (defaultAction) {\n      onAction(event, defaultAction);\n    } else {\n      event.stopPropagation();\n    }\n  };\n  return e(\n    CardStyled,\n    { onClick: handleDefaultAction },\n    e('img', { src: imageUrl }),\n    e('p', null, title),\n    ...buttonsComponents,\n  );\n};\nexport default Card;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Input from './Input';\n\nexport default Input;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\nconst Input = Interface.styled('input')`\n  font-size: 1em;\n  margin: 0.6em;\n  padding: 0.3em 1em;\n  border-radius: 3px;\n\n  color: ${(props) => props.theme.palette.secondary};\n  border: 2px solid ${(props) => props.theme.palette.secondary};\n`;\n\nInput.defaultProps = {\n  theme: Theme,\n};\n\nexport default Input;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Fab from './FAButton';\n\nexport default Fab;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport Interface from '../../interface';\nimport Theme from '../../Theme';\n\n// Source <a href=\"https://icons8.com/icon/81488/speech-bubble\">Speech Bubble icon by Icons8</a>\nconst icon = (_color, _bubbleColor = 'ffffff') => {\n  let color = _color;\n  if (color[0] === '#') color = color.substring(1);\n  let bubbleColor = _bubbleColor;\n  if (bubbleColor[0] === '#') bubbleColor = bubbleColor.substring(1);\n  return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px'%0Awidth='64' height='64'%0AviewBox='0 0 172 172'%0Astyle=' fill:%23000000;'%3E%3Cg fill='none' fill-rule='nonzero' stroke='none' stroke-width='1' stroke-linecap='butt' stroke-linejoin='miter' stroke-miterlimit='10' stroke-dasharray='' stroke-dashoffset='0' font-family='none' font-weight='none' font-size='none' text-anchor='none' style='mix-blend-mode: normal'%3E%3Cpath d='M0,172v-172h172v172z' fill='none'%3E%3C/path%3E%3Cg%3E%3Cpath d='M138.64141,105.21563c0,6.08047 -4.90469,10.98516 -10.98516,10.98516h-83.3125c-6.08047,0 -10.98516,-4.90469 -10.98516,-10.98516v-48.50937c0,-6.08047 4.90469,-10.98516 10.98516,-10.98516h83.3125c6.08047,0 10.98516,4.90469 10.98516,10.98516z' fill='%23${bubbleColor}'%3E%3C/path%3E%3Cpath d='M113.21094,130.98203c-0.87344,0.87344 -2.25078,0.87344 -3.12422,0l-10.51484,-14.88203c-0.87344,-0.87344 -0.87344,-2.25078 0,-3.12422h24.1875c0.87344,0.87344 0.87344,2.25078 0,3.12422z' fill='%23${bubbleColor}'%3E%3C/path%3E%3Cg fill='%23${color}'%3E%3Cpath d='M122.58359,64.36562c0,2.21719 -1.78047,3.99766 -3.99766,3.99766h-65.44063c-2.21719,0 -3.99766,-1.78047 -3.99766,-3.99766v0c0,-2.21719 1.78047,-3.99766 3.99766,-3.99766h65.47422c2.18359,0.03359 3.96406,1.81406 3.96406,3.99766zM122.58359,80.35625c0,2.21719 -1.78047,3.99766 -3.99766,3.99766h-65.44063c-2.21719,0 -3.99766,-1.78047 -3.99766,-3.99766v0c0,-2.21719 1.78047,-3.99766 3.99766,-3.99766h65.47422c2.18359,0 3.96406,1.78047 3.96406,3.99766zM122.58359,96.31328c0,2.21719 -1.78047,3.99766 -3.99766,3.99766h-65.44063c-2.21719,0 -3.99766,-1.78047 -3.99766,-3.99766v0c0,-2.21719 1.78047,-3.99766 3.99766,-3.99766h65.47422c2.18359,0 3.96406,1.78047 3.96406,3.99766z'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A`;\n};\n\nconst Fab = Interface.styled('div')`\nwidth:48px;\nheight:48px;\nborder-radius:100%;\ncolor: ${(props) => props.theme.palette.onSecondary};\nfont-size: 1.25em;\nline-height: 64px;\nbackground: ${(props) => props.theme.palette.secondary};\nbackground-image: ${(props) =>\n  props.icon\n    ? `url(\"${props.icon}\")`\n    : `url(\"${icon(props.theme.palette.secondary, props.theme.palette.bubbleColor)}\")`};\nbackground-repeat:no-repeat;\nbackground-position:50%;\nbackground-size:cover;\nbox-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12);\ncursor:pointer;\ntransition: all .2s ease-in-out;\nanimation:spin 0.45s ease-in-out;\n&:hover {\n  transform: scale(1.05);\n}\n&.isactive {\n  animation:spin 0.45s ease-in-out;\n  background-image: ${(props) => (props.iconActive ? `url(\"${props.iconActive}\");` : undefined)}\n}\n@keyframes spin {\n  from {\n    opacity: 0;\n    transform: scale(0.05);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  } \n}\n`;\n\nFab.defaultProps = {\n  theme: Theme,\n};\n\nexport default Fab;\n","const dispatcher = {\n  states: [],\n  next: 0,\n  reset() {\n    dispatcher.states = [];\n    dispatcher.next = 0;\n  },\n  useState(initialValue) {\n    if (dispatcher.next === dispatcher.states.length) {\n      const value = typeof initialValue === 'function' ? initialValue() : initialValue;\n      const state = {\n        value,\n        setState(newValue) {\n          state.value = newValue;\n          dispatcher.next = 0;\n        },\n      };\n      dispatcher.states.push(state);\n    }\n    const state = dispatcher.states[dispatcher.next];\n    dispatcher.next += 1;\n    return [state.value, state.setState];\n  },\n};\n\nexport default dispatcher.useState;\n\nexport { dispatcher };\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst initFonts = (theme = {}, id) => {\n  const { fonts = {} } = theme;\n  const { text = {}, heading = {} } = fonts;\n  const fontMessengerTextEl = document.createElement('link');\n  fontMessengerTextEl.setAttribute('rel', 'stylesheet');\n  fontMessengerTextEl.setAttribute(\n    'href',\n    text.url || 'https://fonts.googleapis.com/css?family=Raleway:400,700&display=swap',\n  );\n  fontMessengerTextEl.setAttribute('type', 'text/css');\n\n  const fontMessengerHeadingEl = document.createElement('link');\n  fontMessengerHeadingEl.setAttribute('rel', 'stylesheet');\n  fontMessengerHeadingEl.setAttribute(\n    'href',\n    heading.url || 'https://fonts.googleapis.com/css?family=Raleway:400,700&display=swap',\n  );\n  fontMessengerHeadingEl.setAttribute('type', 'text/css');\n\n  const [head] = document.getElementsByTagName('head');\n  head.appendChild(fontMessengerTextEl);\n  head.appendChild(fontMessengerHeadingEl);\n\n  const [root] = document.getElementsByClassName(id);\n  root.style.cssText = `font-family: ${(text.name && `${text.name}, `) || ''}sans-serif;`;\n};\n\nexport default initFonts;\n","/**\n * Copyright (c) Mik BRY\n * mik@mikbry.com\n *\n * This source code is licensed under the license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport useUI from './hooks/ui';\nimport { styled } from './utils/styled';\nimport { useRef } from './utils/builder';\nimport { useSelector } from './utils/store';\n\nconst MessengerApp = async (messages, onMessage, onAction, hideDate) => {\n  const [_isOpen, header = {}, input] = useSelector((state) => [\n    state.messenger.isOpen,\n    state.messenger.header,\n    state.messenger.input,\n  ]);\n  let isOpen = _isOpen;\n  const messengerRef = useRef(null);\n  const fabRef = useRef(null);\n  const handleFabClick = () => {\n    isOpen = !isOpen;\n    const messenger = messengerRef.current;\n    messenger.classList.toggle('isopen');\n    if (messenger.classList.contains('isclosedstart')) {\n      messenger.classList.remove('isclosedstart');\n    } else {\n      messenger.classList.toggle('isclosed');\n    }\n    messenger.firstChild.classList.remove('isexpanded');\n    const fab = fabRef.current;\n    fab.classList.toggle('isactive');\n    onAction('TOGGLE_MESSENGER', isOpen);\n  };\n\n  header.onClose = handleFabClick;\n\n  const handlePrevClick = (event) => {\n    event.stopPropagation();\n  };\n\n  const handleMessage = (message) => {\n    onMessage(message);\n  };\n\n  const ui = await useUI();\n\n  const Messenger = styled(ui.Messenger, {\n    messages,\n    onMessage: handleMessage,\n    onClick: handlePrevClick,\n    onAction,\n    header,\n    input,\n    hideDate,\n  })`\n    position: absolute;\n    overflow: hidden;\n    height: 100%;\n    background: ${(props) => props.theme.palette.background};\n  `;\n  const MessengerBox = styled(\n    'div',\n    {\n      ref: messengerRef,\n      className: `ziiircom-messenger is${isOpen ? 'open' : 'closedstart'}`,\n      onClick: handleFabClick,\n    },\n    Messenger,\n  )`\n    max-height: 700px;\n    width: ${(props) => (props.theme.messenger && props.theme.messenger.width ? props.theme.messenger.width : '500px')};\n    min-height: 320px;\n    z-index: 10;\n    position: fixed;\n    height: calc(100% - 100px);\n    bottom: 100px;\n    right: 28px;\n\n    &.isopen {\n      animation: slide-in 0.5s forwards;\n    }\n\n    &.isclosed {\n      visibility: hidden;\n      animation: slide-out 0.5s ease;\n    }\n\n    &.isclosedstart {\n      visibility: hidden;\n    }\n\n    @media only screen and (max-width: 772px) {\n      .ziiircom-messenger {\n        bottom: 0px !important;\n        right: 0px !important;\n        width: 100% !important;\n      }\n      .ziiircom-messenger.isopen {\n        animation: slide-up 0.5s forwards !important;\n      }\n      .ziiircom-messenger.isclosed {\n        animation: slide-down 0.5s forwards !important;\n      }\n      .isactive {\n        display: none;\n      }\n      .ziiircom-messenger > div {\n        width: 100%;\n        border-bottom-left-radius: 0px;\n        border-bottom-right-radius: 0px;\n        margin: auto 0 0 0;\n      }\n    }\n    @keyframes slide-in {\n      0% {\n        transform: translateX(780px);\n        opacity: 0;\n        visibility: hidden;\n      }\n      100% {\n        transform: translateX(0px);\n        opacity: 1;\n        visibility: visible;\n      }\n    }\n    @keyframes slide-out {\n      0% {\n        transform: translateX(0px);\n        opacity: 1;\n        visibility: visible;\n      }\n      100% {\n        transform: translateX(780px);\n        opacity: 0;\n        visibility: hidden;\n      }\n    }\n    @keyframes slide-up {\n      0% {\n        transform: translateY(780px);\n        opacity: 0;\n        visibility: hidden;\n      }\n      100% {\n        transform: translateY(0px);\n        opacity: 1;\n        visibility: visible;\n      }\n    }\n    @keyframes slide-down {\n      0% {\n        transform: translateY(0px);\n        opacity: 1;\n        visibility: visible;\n      }\n      100% {\n        transform: translateY(780px);\n        opacity: 0;\n        visibility: hidden;\n      }\n    }\n  `;\n\n  const Fab = styled(ui.FAButton, {\n    ref: fabRef,\n    className: `ziiircom-messenger-fab ${isOpen ? 'isactive' : ''}`,\n    onClick: handleFabClick,\n    iconActive:\n      \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='-12 -12 48 48'%3E%3Cg fill='white'%3E%3Cpath d='M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z'/%3E%3C/g%3E%3C/svg%3E\",\n  })`\n    position: fixed;\n    right: 32px;\n    bottom: 32px;\n    z-index: 9;\n  `;\n\n  onAction('INIT');\n\n  return styled(\n    'div',\n    {\n      className: 'ziiircom-messenger-frame',\n    },\n    MessengerBox,\n    Fab,\n  )``;\n};\n\nexport default MessengerApp;\n"],"sourceRoot":""}